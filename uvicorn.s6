#!/usr/bin/env zsh

set -e

export PYTHONDONTWRITEBYTECODE=1
export PYTHONUNBUFFERED=1
# If you rely on request.base_url behind ingress, you may also set:
# ENV FORWARDED_ALLOW_IPS="*"

# Use --reload for debug 
# export PATH="/opt/icorn/.venv/bin:${PATH}"
cd /opt/icorn
su icorn -c "uv run uvicorn main:app --reload --host 0.0.0.0 --port 8080"

